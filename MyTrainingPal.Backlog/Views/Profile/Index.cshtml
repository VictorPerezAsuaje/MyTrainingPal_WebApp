@using MyTrainingPal.Domain.Entities
@using MyTrainingPal.Service.DTO.User
@model UserGetDTO

@{
    ViewData["Title"] = "Profile";
}

@if(Model == null)
{
    <p>There was an error loading the user profile. Please try again later.</p>
}
else
{
    <section class="wrapper">
        <div class="row gutters-sm px-0">
            <div class="col-md-4 mb-3">
                <div class="card p-4 shadow-none">
                    <div class="card-body">
                        <div class="d-flex flex-column align-items-center text-center">
                            <img src="https://i1.rgstatic.net/ii/profile.image/953219836571648-1604276727180_Q512/Victor-Asuaje-2.jpg" alt="User profile" class="rounded-circle profile-pic">
                            <div class="mt-3">
                                <h4>Victor Pérez Asuaje</h4>
                                <p class="text-secondary mb-1">Full Stack Developer</p>
                                <p class="text-muted font-size-sm">Seville, Spain</p>
                                <a class="btn btn-primary" href="https://www.linkedin.com/in/victor-perez-asuaje/" target="_blank">Follow</a>
                                <a class="btn btn-outline-primary" href="https://academiadotnet.com/" target="_blank">Web</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="card mb-3 p-3 shadow-none">
                    <div class="card-body">
                        <div class="row my-4">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Full Name</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                                @Model.FullName
                            </div>
                        </div>
                        <hr>
                        <div class="row my-4">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Email</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                                @Model.Email
                            </div>
                        </div>
                        <hr>
                        <div class="row my-4">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Are you one of our Premium Pals?</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                                @if (@Model.IsPremium)
                                {
                                    <span>You are! <i class="bi bi-patch-check"></i></span>
                                }
                                else
                                {
                                    <p>You are not... 😢</p>
                                    <small>Want to be part of our family?</small>
                                }
                            </div>
                        </div>
                        <hr>
                        <div class="row my-4">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Registered on</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                                @Model.RegistrationDate
                            </div>
                        </div>
                    </div>
                     <div class="card-footer d-flex justify-content-end">
                        <a class="btn btn-secondary disabled" href="#">Edit</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row gutters-sm flex-row-reverse ">
            <div class="col-sm-4 mb-3">
                <div class="card p-3 mb-3 shadow-none">
                        <div class="card-body">
                            <h6 class="d-flex align-items-center mb-3">Stats</h6>
                            <!-- For loop all the Workout Types depending on previous history -->
                            @foreach(var pair in Model.WorkoutTypeFrequency)
                            {
                                <small>@Enum.GetName(pair.Key)</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-primary" role="progressbar" style="width: @pair.Value%" aria-valuenow="@pair.Value" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            }
                        </div>
                </div>
                <div class="card p-3 mb-3 shadow-none">
                    <div class="card-body">
                        <h6 class="d-flex align-items-center mb-3">Who knows...</h6>
                        <!-- Work In Progress -->
                    </div>
                </div>
            </div>

            <div class="col-sm-8 mb-3">
                <div class="card p-3 shadow-none">
                    <div class="card-body">
                        <h6 class="d-flex align-items-center mb-3">Latest Workouts</h6>
                        @for(int i = 0; i < 2; i++)
                        {
                            @if(i < Model.CompletedWorkouts.Count)
                            {
                                <partial name="_WorkoutHistoryCardPartial" model="@Model.CompletedWorkouts[i]" />
                            }
                        }
                        <nav aria-label="Page navigation example">
                            <ul class="pagination justify-content-end">
                            @for(int i = 5; i <= Model.CompletedWorkouts.Count; i+=5)
                            {
                                <li class="page-item">
                                    <a class="page-link" href="#">
                                        @(i/5)
                                    </a>
                                </li>
                            }
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </section>
}
